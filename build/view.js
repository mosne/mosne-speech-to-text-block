import*as e from"@wordpress/interactivity";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const n=(c={getContext:()=>e.getContext,store:()=>e.store},s={},t.d(s,c),s),{actions:o}=(0,n.store)("mosne-speech-to-text-block",{state:{isPlaying:!1,currentVoice:null,utterance:null,voices:[]},actions:{async loadVoices(){console.log("loadVoices");const e=(0,n.getContext)(),t=window.speechSynthesis.getVoices();e.voices=t,e.currentVoice=t[0];const c=document.documentElement.lang,s=t.filter((e=>e.lang.startsWith(c)));console.log("localVoices",s),s.length>0&&(e.voices=s,e.currentVoice=s[0],console.log("current",e.currentVoice),console.log("voices",e.voices)),o.createUtterance()},createUtterance(){const e=(0,n.getContext)(),t=o.getContent(),c=new SpeechSynthesisUtterance(t);c.lang=document.documentElement.lang,e.currentVoice&&(c.voice=e.currentVoice),e.utterance=c},upadateUtterance(){const e=(0,n.getContext)();e.utterance&&(window.speechSynthesis.cancel(),e.isPlaying=!1,o.createUtterance())},Play(){const e=(0,n.getContext)();e.isPlaying=!0,window.speechSynthesis.paused?window.speechSynthesis.resume():e.utterance&&(window.speechSynthesis.cancel(),window.speechSynthesis.speak(e.utterance))},Pause(){(0,n.getContext)().isPlaying=!1,window.speechSynthesis.pause()},Restart(){(0,n.getContext)().isPlaying=!1,window.speechSynthesis.cancel()},changeVoice(e){const t=(0,n.getContext)(),c=t.voices.find((t=>t.voiceURI===e.target.value));c&&(t.currentVoice=c,o.upadateUtterance())},getContent(){let e="",t=document.querySelector("main").cloneNode(!0);return t&&(t.querySelectorAll(".skip-speach").forEach((e=>{e.remove()})),e=t.textContent,t=null),e}},callbacks:{init(){window.speechSynthesis&&(window.speechSynthesis.cancel(),o.loadVoices(),void 0!==window.speechSynthesis.onvoiceschanged&&(window.speechSynthesis.onvoiceschanged=o.loadVoices))},isSelected(){const e=(0,n.getContext)();return e.voice.voiceURI===e.currentVoice.voiceURI}}});var c,s;