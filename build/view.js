import*as e from"@wordpress/interactivity";var t={d:(e,n)=>{for(var c in n)t.o(n,c)&&!t.o(e,c)&&Object.defineProperty(e,c,{enumerable:!0,get:n[c]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const n=(o={getContext:()=>e.getContext,store:()=>e.store},s={},t.d(s,o),s),{actions:c}=(0,n.store)("mosne-text-to-speech-block",{state:{isPlaying:!1,currentVoice:null,utterance:null,voices:[]},actions:{async loadVoices(){const e=(0,n.getContext)(),t=window.speechSynthesis.getVoices();e.voices=t,e.currentVoice=t[0];const o=document.documentElement.lang,s=t.filter((e=>e.lang.startsWith(o)));console.log("localVoices",s),s.length>0&&(e.voices=s,e.currentVoice=s[0]),c.createUtterance()},createUtterance(){const e=(0,n.getContext)(),t=c.getContent(),o=new SpeechSynthesisUtterance(t);o.lang=document.documentElement.lang,e.currentVoice&&(o.voice=e.currentVoice),e.utterance=o},upadateUtterance(){const e=(0,n.getContext)();e.utterance&&(window.speechSynthesis.cancel(),e.isPlaying=!1,c.createUtterance())},Play(){const e=(0,n.getContext)();e.isPlaying=!0,window.speechSynthesis.paused?window.speechSynthesis.resume():e.utterance&&(window.speechSynthesis.cancel(),window.speechSynthesis.speak(e.utterance))},Pause(){(0,n.getContext)().isPlaying=!1,window.speechSynthesis.pause()},Restart(){(0,n.getContext)().isPlaying=!1,window.speechSynthesis.cancel()},changeVoice(e){const t=(0,n.getContext)(),o=t.voices.find((t=>t.voiceURI===e.target.value));o&&(t.currentVoice=o,c.upadateUtterance())},getContent(){let e="",t=document.querySelector("main").cloneNode(!0);return t&&(t.querySelectorAll(".skip-speech").forEach((e=>{e.remove()})),e=t.textContent,t=null),e}},callbacks:{init(){window.speechSynthesis&&(window.speechSynthesis.cancel(),c.loadVoices(),void 0!==window.speechSynthesis.onvoiceschanged&&(window.speechSynthesis.onvoiceschanged=c.loadVoices))},isSelected(){const e=(0,n.getContext)();return e.voice.voiceURI===e.currentVoice.voiceURI}}});var o,s;